# =====================================================
# VARIABLES DE AMBIENTE - STAGING
# =====================================================
# Simula Azure DevOps Library Group: "microservicio-staging"
# Estas variables SOBRESCRIBEN los valores de k8s/values.yaml

# Namespace
NAMESPACE=ns-app-staging

# Deployment
REPLICA_COUNT=2

# Imagen Docker
IMAGE_REGISTRY=docker.io
IMAGE_REPOSITORY=nginx
IMAGE_TAG=1.25-alpine

# Recursos (medios para staging)
MEMORY_REQUEST=256Mi
CPU_REQUEST=200m
MEMORY_LIMIT=512Mi
CPU_LIMIT=400m

# Service
SERVICE_PORT=80

# =====================================================
# CONFIGMAP (Configuración de Aplicación)
# =====================================================
# NOTA: La configuración de la aplicación se gestiona desde app/application.yaml
# El desarrollador mantiene ese archivo con todas las variables
# Aquí solo habilitamos/deshabilitamos el ConfigMap

# Habilitar ConfigMap
CONFIGMAP_ENABLED=true

# =====================================================
# INGRESS (Exposición Externa)
# =====================================================
# NOTA: En STAGING se expone con dominio real para testing previo a producción

# Habilitar Ingress
INGRESS_ENABLED=true

# Clase del Ingress Controller (nginx o alb)
INGRESS_CLASS_NAME=nginx

# Host principal (ajustar al dominio real de staging)
INGRESS_HOST=app.staging.example.com

# Path principal
INGRESS_PATH=/

# TLS/SSL (habilitado en staging)
INGRESS_TLS_ENABLED=true
INGRESS_TLS_HOSTS=app.staging.example.com
INGRESS_TLS_SECRET_NAME=app-staging-tls-secret

# mTLS (opcional - deshabilitado por defecto)
INGRESS_MTLS_ENABLED=false
INGRESS_MTLS_SECRET_NAME=
INGRESS_MTLS_VERIFY_CLIENT=on

# =====================================================
# HORIZONTAL POD AUTOSCALER (HPA)
# =====================================================
# Auto-escalado horizontal basado en métricas de uso
# IMPORTANTE: Requiere Metrics Server instalado en el cluster

# Habilitar HPA (habilitado en staging para pruebas)
HPA_ENABLED=true

# Mínimo de réplicas (staging: moderado)
HPA_MIN_REPLICAS=2

# Máximo de réplicas (staging: límite medio)
HPA_MAX_REPLICAS=5

# Objetivo de utilización de CPU en porcentaje
HPA_TARGET_CPU=70

# Objetivo de utilización de Memoria en porcentaje
HPA_TARGET_MEMORY=80

# =====================================================
# SERVICE ACCOUNT
# =====================================================
# Cuenta de servicio para acceso a recursos de AWS/Azure sin credenciales

# Habilitar ServiceAccount (habilitado en staging para pruebas)
SERVICEACCOUNT_ENABLED=true

# AWS IRSA (IAM Roles for Service Accounts) - ARN del rol de IAM
# Ejemplo: arn:aws:iam::123456789012:role/microservicio-app-staging-role
SERVICEACCOUNT_IRSA_ROLE_ARN=arn:aws:iam::123456789012:role/microservicio-app-staging-role

# Azure Workload Identity - Client ID (para clusters AKS)
SERVICEACCOUNT_AZURE_CLIENT_ID=

# =====================================================
# POD DISRUPTION BUDGET (PDB)
# =====================================================
# Garantiza disponibilidad durante mantenimientos del cluster

# Habilitar PDB (habilitado en staging - 2 réplicas)
PDB_ENABLED=true

# Mínimo de pods disponibles (siempre 1 disponible de 2)
PDB_MIN_AVAILABLE=1

# Máximo de pods no disponibles
# Dejar vacío porque usamos minAvailable
PDB_MAX_UNAVAILABLE=
