# =============================================================================
# CONFIGURACIÓN PARA INSTALACIÓN DE CONTROLADORES DE INGRESS
# =============================================================================
# Este archivo contiene todas las variables necesarias para instalar
# AWS Load Balancer Controller y NGINX Ingress Controller en Amazon EKS
#
# INSTRUCCIONES:
# 1. Edita los valores según tu entorno
# 2. Las variables marcadas como OBLIGATORIAS deben tener valores
# 3. Las variables OPCIONALES pueden dejarse vacías para usar valores por defecto
# =============================================================================

# -----------------------------------------------------------------------------
# CONFIGURACIÓN BÁSICA DEL CLUSTER (OBLIGATORIAS)
# -----------------------------------------------------------------------------

# Nombre del cluster EKS donde se instalarán los controladores
# Ejemplo: "mi-cluster-produccion", "dev-cluster"
export CLUSTER_NAME="<name-cluster>"

# Región AWS donde está ubicado el cluster EKS
# Ejemplos: "us-east-1", "us-west-2", "eu-west-1"
export AWS_REGION="<region>"

# ID de la cuenta AWS (12 dígitos)
# Se usa para crear políticas IAM y roles
# Obtener con: aws sts get-caller-identity --query Account --output text
export AWS_ACCOUNT_ID="<account-id>"

# ID de la VPC donde está el cluster EKS
# Se usa para buscar subnets y security groups automáticamente
# Obtener con: aws eks describe-cluster --name CLUSTER_NAME --query cluster.resourcesVpcConfig.vpcId
export VPC_ID="<vpc-id>"

# -----------------------------------------------------------------------------
# CONFIGURACIÓN DE RED (OPCIONALES)
# -----------------------------------------------------------------------------

# Subnets públicas (separadas por comas)
# OPCIONAL: Dejar vacío para selección automática
# Usar para Load Balancers internet-facing
# Ejemplo: "subnet-abc123,subnet-def456"
export PUBLIC_SUBNETS="<subnet-id>,<subnet-id>"

# Subnets privadas (separadas por comas)
# OPCIONAL: Dejar vacío para selección automática
# Usar para Load Balancers internos
# Ejemplo: "subnet-ghi789,subnet-jkl012"
# export PRIVATE_SUBNETS=""

# Tipo de subnets a usar para el Load Balancer
# VALORES: "public" (internet-facing) o "private" (internal)
# - public: Load Balancer accesible desde internet
# - private: Load Balancer solo accesible desde la VPC
export SUBNET_TYPE="<type-subnet>"

# Security Group personalizado para el Load Balancer
# OPCIONAL: Se combinará automáticamente con el security group del cluster EKS
# El script busca automáticamente el security group del cluster
# Ejemplo: "sg-0a1b2c3d4e5f6g7h8"
export INGRESS_SECURITY_GROUP="<id-sgr-ingress>"

# -----------------------------------------------------------------------------
# CONFIGURACIÓN DE AWS CLI
# -----------------------------------------------------------------------------

# Perfil de AWS CLI a usar
# OBLIGATORIO si usas perfiles múltiples
# Usar "default" si solo tienes un perfil configurado
# Verificar con: aws configure list-profiles
export AWS_PROFILE="<aws-profile>"

# -----------------------------------------------------------------------------
# CONFIGURACIÓN DEL NGINX INGRESS CONTROLLER
# -----------------------------------------------------------------------------

# Namespace donde se instalará NGINX Ingress Controller
# Se creará automáticamente si no existe
# Recomendado: "ingress-nginx" (estándar) o nombre personalizado
export NGINX_NAMESPACE="<nginx-controller-namespace>"

# Nombre del Network Load Balancer que creará NGINX
# Debe ser único en tu cuenta AWS
# Máximo 32 caracteres, solo letras, números y guiones
export NLB_NAME="<nlb-name>"

# Tipo de target para el Load Balancer
# VALORES: "ip" o "instance"
# - ip: Recomendado para Fargate y mejor rendimiento
# - instance: Para nodos EC2 tradicionales
export TARGET_TYPE="<target-type>"

# Certificado SSL/TLS de AWS Certificate Manager
# OPCIONAL: Dejar vacío para usar solo HTTP
# ARN completo del certificado ACM
# Ejemplo: "arn:aws:acm:us-east-1:123456789012:certificate/12345678-1234-1234-1234-123456789012"
# Obtener con: aws acm list-certificates --region REGION
export ACM_CERTIFICATE_ARN="<acm-arn>"

# -----------------------------------------------------------------------------
# CONFIGURACIÓN DE VERSIONES (OPCIONALES)
# -----------------------------------------------------------------------------

# Versión del AWS Load Balancer Controller
# Usar versión específica para entornos de producción
# Verificar versiones en: https://github.com/kubernetes-sigs/aws-load-balancer-controller/releases
export AWS_LB_CONTROLLER_VERSION="1.13.0"

# Versión del NGINX Ingress Controller
# Usar versión específica para entornos de producción
# Verificar versiones en: https://github.com/kubernetes/ingress-nginx/releases
export NGINX_CONTROLLER_VERSION="4.8.3"

# =============================================================================
# NOTAS IMPORTANTES:
# =============================================================================
# 
# 1. SEGURIDAD:
#    - Los security groups se combinan automáticamente
#    - Se crean roles IAM con permisos mínimos necesarios
#    - Los certificados ACM proporcionan cifrado TLS
#
# 2. COSTOS:
#    - Network Load Balancer: ~$16-45/mes
#    - Application Load Balancer: ~$16-22/mes  
#    - Data Processing: $0.006-0.008 por GB
#
# 3. LÍMITES AWS:
#    - Máximo 50 Load Balancers por región
#    - Máximo 1000 Target Groups por región
#    - Verificar límites en AWS Service Quotas
#
# 4. TROUBLESHOOTING:
#    - Ejecutar ./verify-installation.sh para diagnósticos
#    - Revisar logs: kubectl logs -n kube-system deployment/aws-load-balancer-controller
#    - Verificar eventos: kubectl get events --sort-by='.lastTimestamp'
#
# 5. COMANDOS ÚTILES:
#    - Obtener Account ID: aws sts get-caller-identity --query Account --output text
#    - Obtener VPC ID: aws eks describe-cluster --name CLUSTER_NAME --query cluster.resourcesVpcConfig.vpcId
#    - Listar subnets: aws ec2 describe-subnets --filters "Name=vpc-id,Values=VPC_ID" --query 'Subnets[*].[SubnetId,AvailabilityZone,MapPublicIpOnLaunch]'
#    - Listar certificados: aws acm list-certificates --region REGION
#    - Verificar perfiles: aws configure list-profiles
#
# =============================================================================
