--- /var/folders/pf/gvfhmmdd29nggstgfm_d3zgr0000gp/T/tmp.U9qUSZyV7x/defaults.yaml	2025-10-24 15:18:32
+++ /Users/felipe.arcienagas/Documents/Work/Chapter-CloudOps/ficohsa/kubernetes/cloudops-ref-template-k8s-helm/base-kubernetes-aplicacion/rendered-manifests_20251024_151831/all-manifests.yaml	2025-10-24 15:18:32
@@ -1,10 +1,116 @@
 ---
+# Source: microservicio-base/templates/pdb.yaml
+apiVersion: policy/v1
+kind: PodDisruptionBudget
+metadata:
+  name: microservicio-app-pdb
+  namespace: ns-app-dev
+  labels:
+    app: microservicio-app
+    env: 
+spec:
+  minAvailable: 1
+  selector:
+    matchLabels:
+      app: microservicio-app
+---
+# Source: microservicio-base/templates/serviceaccount.yaml
+apiVersion: v1
+kind: ServiceAccount
+metadata:
+  name: microservicio-app-sa
+  namespace: ns-app-dev
+  labels:
+    app: microservicio-app
+    env: 
+  annotations:
+    # AWS IRSA (IAM Roles for Service Accounts)
+    # Permite que el pod asuma un IAM role de AWS sin credenciales
+    eks.amazonaws.com/role-arn: arn:aws:iam::161156235207:role/Rols3-sa-poc
+---
+# Source: microservicio-base/templates/configmap.yaml
+apiVersion: v1
+kind: ConfigMap
+metadata:
+  name: microservicio-app-config
+  namespace: ns-app-dev
+  labels:
+    app: microservicio-app
+data:
+  # application.yaml se monta como archivo en el contenedor
+  # Spring Boot lo lee automáticamente desde /app/config/application.yaml
+  application.yaml: |
+    api:
+      external:
+        auth:
+          timeout: 5000
+          url: http://auth-service-dev.internal/api/v1
+        notification:
+          timeout: 3000
+          url: http://notification-service-dev.internal/api/v1
+        payment:
+          timeout: 10000
+          url: http://payment-service-dev.internal/api/v1
+    cache:
+      enabled: false
+      redis:
+        database: 0
+        host: redis-dev.internal
+        port: 6379
+      ttl: 300
+    custom:
+      businessLogic:
+        maxRetries: 3
+        timeout: 5000
+    features:
+      betaFeatures:
+        enabled: true
+      maintenance:
+        enabled: false
+      newUI:
+        enabled: true
+    logging:
+      level:
+        application: DEBUG
+        root: DEBUG
+        springframework: INFO
+        web: DEBUG
+      pattern:
+        console: '%d{yyyy-MM-dd HH:mm:ss} - %msg%n'
+    management:
+      endpoint:
+        health:
+          probes:
+            enabled: true
+          showDetails: always
+      endpoints:
+        web:
+          basePath: /
+          exposure:
+            include: health,info,metrics
+      health:
+        liveness:
+          enabled: true
+        readiness:
+          enabled: true
+    server:
+      port: 8080
+    spring:
+      datasource:
+        driverClassName: org.postgresql.Driver
+        hikari:
+          connectionTimeout: 30000
+          maximumPoolSize: 10
+          minimumIdle: 2
+        url: jdbc:postgresql://db-dev.internal:5432/myapp_dev
+        username: myapp_user
+---
 # Source: microservicio-base/templates/service.yaml
 apiVersion: v1
 kind: Service
 metadata:
   name: microservicio-app-service
-  namespace: default
+  namespace: ns-app-dev
   labels:
     app: microservicio-app
 spec:
@@ -22,12 +128,12 @@
 kind: Deployment
 metadata:
   name: microservicio-app-deployment
-  namespace: default
+  namespace: ns-app-dev
   labels:
     app: microservicio-app
     version: "1.25-alpine"
 spec:
-  replicas: 2
+  replicas: 3
 
   selector:
     matchLabels:
@@ -40,6 +146,7 @@
         version: "1.25-alpine"
 
     spec:
+      serviceAccountName: microservicio-app-sa
       containers:
       - name: microservicio-app
         image: "docker.io/nginx:1.25-alpine"
@@ -53,6 +160,11 @@
         # Montaje de ConfigMap como archivo
         # application.yaml se monta en /app/config/application.yaml
         # Spring Boot lo lee automáticamente
+        volumeMounts:
+        - name: config-volume
+          mountPath: /app/config/application.yaml
+          subPath: application.yaml
+          readOnly: true
 
         # Recursos (Requests y Limits)
         resources:
@@ -85,3 +197,93 @@
 
       # Volúmenes
       # ConfigMap se monta como archivo para que la app lo lea
+      volumes:
+      - name: config-volume
+        configMap:
+          name: microservicio-app-config
+          items:
+          - key: application.yaml
+            path: application.yaml
+---
+# Source: microservicio-base/templates/hpa.yaml
+apiVersion: autoscaling/v2
+kind: HorizontalPodAutoscaler
+metadata:
+  name: microservicio-app-hpa
+  namespace: ns-app-dev
+  labels:
+    app: microservicio-app
+    env: 
+spec:
+  scaleTargetRef:
+    apiVersion: apps/v1
+    kind: Deployment
+    name: microservicio-app-deployment
+  minReplicas: 1
+  maxReplicas: 5
+  metrics:
+  - type: Resource
+    resource:
+      name: cpu
+      target:
+        type: Utilization
+        averageUtilization: 70
+  - type: Resource
+    resource:
+      name: memory
+      target:
+        type: Utilization
+        averageUtilization: 80
+  behavior:
+    scaleDown:
+      policies:
+      - periodSeconds: 60
+        type: Percent
+        value: 50
+      - periodSeconds: 60
+        type: Pods
+        value: 2
+      selectPolicy: Min
+      stabilizationWindowSeconds: 300
+    scaleUp:
+      policies:
+      - periodSeconds: 30
+        type: Percent
+        value: 100
+      - periodSeconds: 30
+        type: Pods
+        value: 4
+      selectPolicy: Max
+      stabilizationWindowSeconds: 60
+---
+# Source: microservicio-base/templates/ingress.yaml
+apiVersion: networking.k8s.io/v1
+kind: Ingress
+metadata:
+  name: microservicio-app-ingress
+  namespace: ns-app-dev
+  labels:
+    app: microservicio-app
+    env: 
+  annotations:
+    # Nginx Ingress Controller annotations
+    nginx.ingress.kubernetes.io/ssl-redirect: "false"
+    nginx.ingress.kubernetes.io/force-ssl-redirect: "false"
+    nginx.ingress.kubernetes.io/rewrite-target: /
+    # AWS Load Balancer Controller annotations (si usas AWS)
+    # mTLS annotations (opcional - para seguridad avanzada)
+    # Custom annotations adicionales
+spec:
+  ingressClassName: nginx
+
+  rules:
+    -
+      http:
+        paths:
+        - path: /v2
+          pathType: Prefix
+          backend:
+            service:
+              name: microservicio-app-service
+              port:
+                number: 80
