{{/*
EKS Controllers Helm Chart - Installation Notes
*/}}
========================================
EKS CONTROLLERS - DEPLOYMENT SUCCESS
========================================

{{- if .Values.global.clusterName }}
Cluster Information:
  Cluster Name: {{ .Values.global.clusterName }}
  AWS Region: {{ .Values.global.awsRegion }}
  AWS Account: {{ .Values.global.awsAccountId }}
{{- end }}

Installed Components:
{{- if .Values.nodeclass.enabled }}
✅ Karpenter NodeClass: ENABLED
  - Name: {{ include "eks-controllers.nodeclass.name" . }}
  - Role: {{ .Values.nodeclass.role }}
  {{- if .Values.nodeclass.ephemeralStorage }}
  - Storage: {{ .Values.nodeclass.ephemeralStorage.size | default "80Gi" }}
  {{- end }}
{{- else }}
❌ Karpenter NodeClass: DISABLED
{{- end }}

{{- if .Values.nodepool.enabled }}
✅ Karpenter NodePool: ENABLED
  - Name: {{ include "eks-controllers.nodepool.name" . }}
  - NodeClass: {{ .Values.nodepool.nodeClassRef.name | default (include "eks-controllers.nodeclass.name" .) }}
  {{- if .Values.nodepool.limits }}
  - Limits:
    {{- if .Values.nodepool.limits.cpu }}
    CPU: {{ .Values.nodepool.limits.cpu }}
    {{- end }}
    {{- if .Values.nodepool.limits.memory }}
    Memory: {{ .Values.nodepool.limits.memory }}
    {{- end }}
  {{- end }}
{{- else }}
❌ Karpenter NodePool: DISABLED
{{- end }}

{{- if index .Values "aws-load-balancer-controller" "enabled" }}
✅ AWS Load Balancer Controller: ENABLED
  - Replicas: {{ index .Values "aws-load-balancer-controller" "replicaCount" | default 2 }}
{{- else }}
❌ AWS Load Balancer Controller: DISABLED
{{- end }}

{{- if index .Values "cluster-autoscaler" "enabled" }}
✅ Cluster Autoscaler: ENABLED  
  - Replicas: {{ index .Values "cluster-autoscaler" "replicaCount" | default 1 }}
{{- else }}
❌ Cluster Autoscaler: DISABLED
{{- end }}

Commands to check status:
{{- if .Values.nodeclass.enabled }}
  kubectl get nodeclass {{ include "eks-controllers.nodeclass.name" . }} -o wide
{{- end }}
{{- if .Values.nodepool.enabled }}
  kubectl get nodepool {{ include "eks-controllers.nodepool.name" . }} -o wide
  kubectl get nodes -l karpenter.sh/nodepool={{ include "eks-controllers.nodepool.name" . }}
{{- end }}
  kubectl get pods -n {{ .Release.Namespace }}
  kubectl get deployments -n {{ .Release.Namespace }}

{{- if .Values.nodeclass.enabled }}
Describe Karpenter resources:
  kubectl describe nodeclass {{ include "eks-controllers.nodeclass.name" . }}
{{- end }}
{{- if .Values.nodepool.enabled }}
  kubectl describe nodepool {{ include "eks-controllers.nodepool.name" . }}
{{- end }}

For more information: https://docs.aws.amazon.com/eks/
