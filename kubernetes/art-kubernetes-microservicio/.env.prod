# =====================================================
# VARIABLES DE AMBIENTE - PRODUCCIÓN
# =====================================================
# Simula Azure DevOps Library Group: "microservicio-prod"
# Estas variables SOBRESCRIBEN los valores de k8s/values.yaml

# Namespace
NAMESPACE=ns-app-prod

# Deployment
REPLICA_COUNT=5

# Imagen Docker
IMAGE_REGISTRY=docker.io
IMAGE_REPOSITORY=nginx
IMAGE_TAG=1.25-alpine

# Recursos (altos para producción)
MEMORY_REQUEST=512Mi
CPU_REQUEST=500m
MEMORY_LIMIT=1Gi
CPU_LIMIT=1000m

# Service
SERVICE_PORT=80

# =====================================================
# CONFIGMAP (Configuración de Aplicación)
# =====================================================
# NOTA: La configuración de la aplicación se gestiona desde app/application.yaml
# El desarrollador mantiene ese archivo con todas las variables
# Aquí solo habilitamos/deshabilitamos el ConfigMap

# Habilitar ConfigMap
CONFIGMAP_ENABLED=true

# =====================================================
# INGRESS (Exposición Externa)
# =====================================================
# NOTA: En PRODUCCIÓN se expone con dominio real, TLS y mTLS habilitados

# Habilitar Ingress
INGRESS_ENABLED=true

# Clase del Ingress Controller (nginx o alb)
INGRESS_CLASS_NAME=nginx

# Host principal (ajustar al dominio real de producción)
INGRESS_HOST=app.example.com

# Path principal
INGRESS_PATH=/

# TLS/SSL (habilitado en producción)
INGRESS_TLS_ENABLED=true
INGRESS_TLS_HOSTS=app.example.com
INGRESS_TLS_SECRET_NAME=app-prod-tls-secret

# mTLS (habilitado en producción para mayor seguridad)
INGRESS_MTLS_ENABLED=true
INGRESS_MTLS_SECRET_NAME=app-prod-mtls-client-secret
INGRESS_MTLS_VERIFY_CLIENT=on

# =====================================================
# HORIZONTAL POD AUTOSCALER (HPA)
# =====================================================
# Auto-escalado horizontal basado en métricas de uso
# IMPORTANTE: Requiere Metrics Server instalado en el cluster

# Habilitar HPA (habilitado en producción)
HPA_ENABLED=true

# Mínimo de réplicas (producción: alto para disponibilidad)
HPA_MIN_REPLICAS=3

# Máximo de réplicas (producción: límite alto para manejar picos)
HPA_MAX_REPLICAS=10

# Objetivo de utilización de CPU en porcentaje
HPA_TARGET_CPU=70

# Objetivo de utilización de Memoria en porcentaje
HPA_TARGET_MEMORY=80

# =====================================================
# SERVICE ACCOUNT
# =====================================================
# Cuenta de servicio para acceso a recursos de AWS/Azure sin credenciales

# Habilitar ServiceAccount (habilitado en producción)
SERVICEACCOUNT_ENABLED=true

# AWS IRSA (IAM Roles for Service Accounts) - ARN del rol de IAM
# Ejemplo: arn:aws:iam::123456789012:role/microservicio-app-prod-role
SERVICEACCOUNT_IRSA_ROLE_ARN=arn:aws:iam::123456789012:role/microservicio-app-prod-role

# Azure Workload Identity - Client ID (para clusters AKS)
SERVICEACCOUNT_AZURE_CLIENT_ID=

# =====================================================
# POD DISRUPTION BUDGET (PDB)
# =====================================================
# Garantiza disponibilidad durante mantenimientos del cluster

# Habilitar PDB (habilitado en producción - alta disponibilidad)
PDB_ENABLED=true

# Mínimo de pods disponibles (mínimo 2 de 3-10 réplicas siempre disponibles)
PDB_MIN_AVAILABLE=2

# Máximo de pods no disponibles
# Dejar vacío porque usamos minAvailable
PDB_MAX_UNAVAILABLE=
