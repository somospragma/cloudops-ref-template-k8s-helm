# =====================================================
# VARIABLES DE AMBIENTE - DESARROLLO
# =====================================================
# Simula Azure DevOps Library Group: "microservicio-dev"
# Estas variables SOBRESCRIBEN los valores de k8s/values.yaml

# Namespace
NAMESPACE=ns-app-dev

# Deployment
REPLICA_COUNT=3

# Imagen Docker
IMAGE_REGISTRY=docker.io
IMAGE_REPOSITORY=nginx
IMAGE_TAG=1.25-alpine

# Recursos (conservadores para dev)
MEMORY_REQUEST=128Mi
CPU_REQUEST=100m
MEMORY_LIMIT=256Mi
CPU_LIMIT=200m

# Service
SERVICE_PORT=80

# =====================================================
# CONFIGMAP (Configuración de Aplicación)
# =====================================================
# NOTA: La configuración de la aplicación se gestiona desde app/application.yaml
# El desarrollador mantiene ese archivo con todas las variables
# Aquí solo habilitamos/deshabilitamos el ConfigMap

# Habilitar ConfigMap
CONFIGMAP_ENABLED=true

# =====================================================
# INGRESS (Exposición Externa)
# =====================================================
# NOTA: En DEV típicamente se usa port-forward para pruebas locales
# El ingress se puede habilitar si necesitas probar con dominio real

# Habilitar Ingress (false para dev, true para staging/prod)
INGRESS_ENABLED=true

# Clase del Ingress Controller (nginx o alb)
INGRESS_CLASS_NAME=nginx

# =====================================================
# CONFIGURACIÓN DEL HOST (OPCIONAL)
# =====================================================
# Opción 1: CON host específico (solo acepta ese dominio)
#   INGRESS_HOST=app.dev.example.com
#   → Acceso: http://app.dev.example.com/pruebas
#
# Opción 2: SIN host (acepta cualquier IP/dominio - catch-all)
#   INGRESS_HOST=
#   → Acceso: http://<IP-LoadBalancer>/pruebas
#   → Acceso: http://cualquier-dominio.com/pruebas
#
# Configuración actual: CON host
# INGRESS_HOST=app.dev.example.com

# Path principal (ejemplo: /pruebas para enrutar a este servicio)
INGRESS_PATH=/ficohsa

# IMPORTANTE: Nginx escucha en "/" (raíz), no en "/pruebas"
# Por eso necesitamos reescribir el path /pruebas → / antes de llegar a nginx
INGRESS_REWRITE_TARGET=/

# TLS/SSL
INGRESS_TLS_ENABLED=false
INGRESS_TLS_HOSTS=app.dev.example.com
INGRESS_TLS_SECRET_NAME=app-dev-tls-secret

# mTLS (deshabilitado en dev normalmente)
INGRESS_MTLS_ENABLED=false
INGRESS_MTLS_SECRET_NAME=
INGRESS_MTLS_VERIFY_CLIENT=on

# =====================================================
# HORIZONTAL POD AUTOSCALER (HPA)
# =====================================================
# Auto-escalado horizontal basado en métricas de uso
# IMPORTANTE: Requiere Metrics Server instalado en el cluster

# Habilitar HPA (false en dev, true en staging/prod)
HPA_ENABLED=true

# Mínimo de réplicas (en dev normalmente 1)
HPA_MIN_REPLICAS=1

# Máximo de réplicas (en dev conservador)
HPA_MAX_REPLICAS=5

# Objetivo de utilización de CPU en porcentaje
# Cuando supera este valor, HPA crea más réplicas
HPA_TARGET_CPU=70

# Objetivo de utilización de Memoria en porcentaje (opcional)
# Dejar vacío si solo quieres escalar por CPU
HPA_TARGET_MEMORY=80

# =====================================================
# SERVICE ACCOUNT
# =====================================================
# Cuenta de servicio para acceso a recursos de AWS/Azure sin credenciales

# Habilitar ServiceAccount (false en dev, true en staging/prod si necesita AWS/Azure)
SERVICEACCOUNT_ENABLED=true

# AWS IRSA (IAM Roles for Service Accounts) - ARN del rol de IAM
# Solo necesario si el pod requiere acceso a servicios de AWS (S3, DynamoDB, etc.)
# Ejemplo: arn:aws:iam::123456789012:role/microservicio-app-dev-role
SERVICEACCOUNT_IRSA_ROLE_ARN=arn:aws:iam::161156235207:role/Rols3-sa-poc

# Azure Workload Identity - Client ID (para clusters AKS)
# Solo necesario si el pod requiere acceso a servicios de Azure
# Ejemplo: 8e3928e1-03e5-4ba4-9e31-e1e2fe63f720
SERVICEACCOUNT_AZURE_CLIENT_ID=

# =====================================================
# POD DISRUPTION BUDGET (PDB)
# =====================================================
# Garantiza disponibilidad durante mantenimientos del cluster
# IMPORTANTE: Solo tiene sentido con múltiples réplicas

# Habilitar PDB (false en dev porque solo hay 1 réplica)
PDB_ENABLED=true

# Mínimo de pods disponibles (número o porcentaje ej: 1, "50%")
# Solo se usa si PDB_ENABLED=true
PDB_MIN_AVAILABLE=1

# Máximo de pods no disponibles (número o porcentaje ej: 1, "25%")
# IMPORTANTE: Solo usar minAvailable O maxUnavailable, no ambos
# Dejar vacío si usas minAvailable
PDB_MAX_UNAVAILABLE=
